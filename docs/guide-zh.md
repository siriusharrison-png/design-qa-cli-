# 品控督查使用指南

> 写给不会代码的设计师和团队成员

---

## 品控督查是什么？

想象一下，你们公司有一套**设计规范**：品牌蓝是 `#1161fe`，标题用 16px，按钮间距是 8px。

但开发写代码时，可能会「随手」写一个差不多的颜色 `#1060fd`，或者间距写成 7px。肉眼几乎看不出差别，但这些「差不多」积累多了，产品就会越来越不统一。

**品控督查就是一个「自动找茬」的工具** —— 它会扫描代码，把所有「没用规范、自己随便写的」样式都找出来，告诉你：

> "这里你写了 `#1060fd`，但规范里没有这个颜色，最接近的是 `#1161fe`（品牌蓝），要不要改成规范的？"

---

## 它能帮你做什么？

| 能力 | 说明 |
|------|------|
| **找出硬编码的颜色** | 代码里直接写了 `#xxx` 的地方，告诉你应该用哪个规范颜色 |
| **找出硬编码的字号** | 代码里写了 `14px`、`18px` 这种，告诉你对应的规范变量 |
| **找出不规范的间距** | 代码里的间距不在规范列表里（比如规范只有 4/8/12/16，但代码写了 10px） |
| **一键自动修复** | 颜色和字号可以自动替换成规范的写法 |
| **生成检测报告** | 生成一个网页版报告，可以分享给团队看，里面有颜色对比图 |
| **卡住不合格的代码** | 在代码合并前自动检查，不合格的不让合并（需要配合 GitHub） |

---

## 谁来用？怎么用？

### 开发同学日常自检

开发写完代码后，跑一下检测：

```
npx design-qa check ./src
```

终端会显示类似这样的结果：

```
📄 Button.tsx
   🎨 第8行  #1060fd → 建议改成 var(--brand-primary-1)
   📏 第12行  15px → 规范里没有，最接近的是 16px

📄 Card.css
   🔤 第13行  18px → 建议改成 var(--font-size-18)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
❌ 发现 3 个问题：
   🎨 颜色问题: 1 个
   📏 间距问题: 1 个
   🔤 字号问题: 1 个
```

开发看到后就知道哪里要改了。

---

### 懒人模式：自动修复

如果问题太多，一个个改太累，可以让工具自动改：

```
npx design-qa check ./src --fix
```

工具会自动把颜色和字号替换成规范写法。

**注意**：间距不会自动改，因为改间距可能影响排版，需要人工判断。

---

### 给设计师/领导看的报告

想把检测结果分享给不会看代码的人？生成一个网页报告：

```
npx design-qa check ./src --output report.html
```

打开 `report.html` 会看到：
- 问题总数统计
- 每个问题的位置和建议
- **颜色对比图**：左边是代码里写的颜色，右边是建议的规范颜色，一眼就能看出差别
- 可以导出 JSON 或 CSV 表格

---

### 代码合并前自动拦截

这个是给有 GitHub 的团队用的。配置好以后，每次有人提交代码，GitHub 会自动跑检测：
- 如果有问题 → 不让合并，必须改好才能合
- 如果没问题 → 正常合并

这样就能**从源头保证**所有合并进去的代码都是符合规范的。

配置方法：在项目里创建 `.github/workflows/design-qa.yml` 文件：

```yaml
name: Design QA
on: [push, pull_request]
jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
      - run: npx design-qa check ./src --ci
```

---

## 前提条件

工具需要知道「什么是规范」，所以要给它一个**规范文件**（`design-tokens.css`）。

这个文件长这样：

```css
:root {
  /* 颜色 */
  --brand-primary-1: #1161fe;
  --text-1: #181818;

  /* 间距（以 space- 开头） */
  --space-4: 4px;
  --space-8: 8px;
  --space-16: 16px;

  /* 字号（以 font-size- 开头） */
  --font-size-14: 14px;
  --font-size-16: 16px;
}
```

这个文件可以从 Figma 的 Design Tokens 插件导出，也可以手动写。

把这个文件放到项目根目录，工具就会自动读取。如果文件放在其他位置，用 `--tokens` 参数指定：

```
npx design-qa check ./src --tokens ./my-tokens.css
```

---

## 常见问题

### Q: 我不是开发，怎么看报告？

让开发跑一下生成报告的命令，然后把 `report.html` 文件发给你。双击打开就能在浏览器里看到可视化的结果。

### Q: 为什么间距不能自动修复？

因为间距改动可能会影响整体布局。比如把 `10px` 改成 `8px`，可能会导致元素挤在一起或者对不齐。这种需要设计师和开发一起判断怎么改比较合适。

### Q: 检测出来的问题一定要改吗？

不一定。有些情况下，硬编码是故意的（比如某个特殊页面需要不一样的颜色）。工具只是帮你「发现」这些地方，改不改由团队决定。

### Q: 支持检测哪些类型的文件？

- JavaScript / TypeScript（`.js` / `.jsx` / `.ts` / `.tsx`）
- CSS / SCSS（`.css` / `.scss`）
- Vue / Svelte（`.vue` / `.svelte`）

---

## 一句话总结

**品控督查 = 设计还原度的自动检查员**

它不会帮你判断「这个设计好不好看」，但它会帮你确保「代码写的和设计稿规范一致」。
